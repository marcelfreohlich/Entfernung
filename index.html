function findNearestDesigner() {
  const customerAddress = document.getElementById("customerAddress").value;
  if (!customerAddress) {
    document.getElementById("result").innerHTML = "Bitte gib eine Adresse ein!";
    return;
  }

  // Geocoding des Kundenstandorts
  $.get(`https://api.opencagedata.com/geocode/v1/json?q=${encodeURIComponent(customerAddress)}&key=${apiKey}`, function (data) {
    if (data.results && data.results.length > 0) {
      const customerLocation = data.results[0].geometry;
      let nearestDesigner = null;
      let minDistance = Infinity;

      // Vergleiche mit den Designer-Adressen
      designers.forEach(designer => {
        $.get(`https://api.opencagedata.com/geocode/v1/json?q=${encodeURIComponent(designer.address)}&key=${apiKey}`, function (designerData) {
          if (designerData.results && designerData.results.length > 0) {
            const designerLocation = designerData.results[0].geometry;
            const distance = calculateDistance(customerLocation, designerLocation);

            // Berechne Stunden und Minuten für die Fahrtzeit
            const travelTime = (distance / 50) * 60; // Annahme: Durchschnittliche Fahrgeschwindigkeit 50 km/h
            const hours = Math.floor(travelTime / 60); // Ganze Stunden
            const minutes = Math.round(travelTime % 60); // Restliche Minuten

            if (distance < minDistance) {
              minDistance = distance;
              nearestDesigner = {
                name: designer.name,
                travelTime: `${hours} Stunden und ${minutes} Minuten`
              };
            }

            if (designer === designers[designers.length - 1]) {
              displayResult(nearestDesigner);
            }
          }
        });
      });
    }
  });
}

function displayResult(designer) {
  if (designer) {
    document.getElementById("result").innerHTML = `Der nächstgelegene Designer ist: ${designer.name} (Fahrtzeit: ${designer.travelTime})`;
  } else {
    document.getElementById("result").innerHTML = "Kein Designer gefunden.";
  }
}
